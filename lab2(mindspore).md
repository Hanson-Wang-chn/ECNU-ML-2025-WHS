# 实验二：线性回归模型训练与评估

## 实验目的：
- 理解线性回归的基本原理
- 学习MindSpore的使用
- 掌握模型训练、预测和评估流程

## 实验环境：
- MindSpore 2.2
- 华为云ModelArts
- 主要库：
  - MindSpore
  - numpy
  - matplotlib 

## 实验内容：
### 1. 导入MindSpore模块和辅助模块
- 导入MindSpore中nn, Tensor, ops, transforms, vision, GeneratorDataset 等模块
  
### 2. 生成数据
- 根据线性函数y = -5 * x + 0.1生成模拟数据，并在其中加入少许扰动。

  
### 3. 模型构建
- 使用MindSpore提供的nn.Dense(1, 1)算子作为线性模型，其中(1, 1)表示线性模型的输入和输出皆是1维，即w是1x1的矩阵。算子会随机初始化权重w和偏置b。
- 采用均方差作为损失函数。
- 采用随机梯度下降对模型进行优化。
- 由于需要使用函数式自动微分，需要将神经网络和损失函数的调用封装为一个前向计算函数。
- 完成后，使用value_and_grad接口获得微分函数，用于计算梯度。
- 定义train_step函数，计算梯度并用于优化，返回损失。

### 4. 模型训练
- epochs = 20，batch_size = 1

### 5. 模型预测
- 查看参数的名称、维度、数据类型、数值以及是否求导（当requires_grad=True时，参数需要求导，进行反向传播）。
- 查看第一个可训练参数
- 将第一个参数数组化
- 使用训练好的模型进行预测

### 6. 可视化
- 可视化模拟的样本数据、真实的线性函数和训练得到的线性模型

## 要求：
- **实验报告**：完成实验后，撰写实验报告，实验报告中应包含实验主要步骤的Python代码，可注释说明。
- **结果可视化**：使用matplotlib对模型的预测结果进行可视化处理，使用**散点图**展示对比预测值和实际值。

## 需提交：
- **实验报告**：详细描述实验过程、结果和分析的文档。
